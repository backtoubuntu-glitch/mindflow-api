<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Educational Chess - MindFlow</title>
    <link rel="stylesheet" href="assets/css/global-deep-tech.css">
    <link rel="stylesheet" href="https://unpkg.com/@chrisoakman/chessboardjs@1.0.0/dist/chessboard-1.0.0.min.css">
    <style>
        .chess-container {
            padding: 100px 20px 40px;
            max-width: 1400px;
            margin: 0 auto;
            display: grid;
            grid-template-columns: 1fr 400px;
            gap: 30px;
        }
        
        .chess-board {
            background: var(--card-surface);
            border-radius: 15px;
            padding: 30px;
            text-align: center;
            border: 1px solid #2A2A2A;
        }
        
        .chess-sidebar {
            background: var(--card-surface);
            border-radius: 15px;
            padding: 25px;
            border: 1px solid #2A2A2A;
        }
        
        #chessBoard {
            max-width: 400px;
            margin: 0 auto;
            border: 2px solid var(--cyber-blue) !important;
            border-radius: 8px;
        }
        
        .chess-controls {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 10px;
            margin: 20px 0;
        }
        
        .difficulty-selector {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 8px;
            margin: 15px 0;
        }
        
        .difficulty-btn {
            padding: 10px;
            border: 2px solid #2A2A2A;
            border-radius: 6px;
            background: var(--card-surface);
            cursor: pointer;
            text-align: center;
            transition: all 0.3s ease;
            color: var(--pure-white);
        }
        
        .difficulty-btn.active {
            border-color: var(--cyber-blue);
            background: var(--cyber-blue);
            color: var(--tech-black);
            font-weight: 600;
        }
        
        .chess-stats {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 15px;
            margin: 20px 0;
        }
        
        .move-history {
            max-height: 300px;
            overflow-y: auto;
            border: 1px solid #2A2A2A;
            border-radius: 8px;
            padding: 15px;
            margin: 15px 0;
            background: var(--dark-space);
        }
        
        .move-item {
            padding: 8px 12px;
            border-bottom: 1px solid #2A2A2A;
            display: flex;
            justify-content: space-between;
        }
        
        .move-item:last-child {
            border-bottom: none;
        }
        
        .khensani-chat {
            background: rgba(0, 212, 255, 0.1);
            border-radius: 12px;
            padding: 20px;
            margin: 20px 0;
            border-left: 4px solid var(--cyber-blue);
        }
        
        @media (max-width: 968px) {
            .chess-container {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <!-- Consistent Navigation -->
    <nav class="tech-navbar">
        <div class="nav-brand">
            <span class="brain-icon">üß†</span>
            <span class="brand-main">MindFlow</span>
            <span class="brand-sub">Powered by MindTech</span>
        </div>
        <div class="tech-nav-links">
            <a href="index.html" class="nav-link">Home</a>
            <a href="dashboard.html" class="nav-link">Dashboard</a>
            <a href="curriculum.html" class="nav-link">Khensani AI</a>
            <a href="chess.html" class="nav-link active">Chess</a>
            <a href="parent-teacher-portal.html" class="nav-link">Parent Portal</a>
            <a href="corporate-portal.html" class="nav-link">Corporate</a>
            <a href="safety.html" class="nav-link">Safety</a>
            <a href="login.html" class="nav-link">Login</a>
        </div>
    </nav>

    <div class="chess-container">
        <!-- Chess Board Section -->
        <div class="chess-board">
            <h1 class="tech-heading">‚ôüÔ∏è Educational Chess</h1>
            <p>Develop strategic thinking with AI-powered chess coaching</p>
            
            <div id="chessBoard"></div>
            
            <div class="chess-controls">
                <button class="tech-btn" onclick="window.chessManager.newGame()">üîÑ New Game</button>
                <button class="tech-btn" onclick="window.chessManager.getHint()">üí° Get Hint</button>
                <button class="tech-btn" onclick="window.chessManager.undoMove()">‚Ü©Ô∏è Undo Move</button>
                <button class="tech-btn" style="background: transparent; border: 2px solid var(--neon-red); color: var(--neon-red);" 
                        onclick="window.chessManager.resign()">üè≥Ô∏è Resign</button>
            </div>

            <div class="khensani-chat">
                <div id="khensaniMessage" style="font-style: italic; margin-bottom: 15px;">
                    "Hi! I'm Khensani AI. I'll help you learn chess strategy and improve your thinking skills. Ready to make your first move?"
                </div>
                <button class="tech-btn" onclick="window.chessManager.khensaniAdvice()" style="width: 100%;">ü§ñ Get AI Advice</button>
            </div>

            <div class="difficulty-selector">
                <div class="difficulty-btn active" onclick="setDifficulty('beginner')">Beginner</div>
                <div class="difficulty-btn" onclick="setDifficulty('intermediate')">Intermediate</div>
                <div class="difficulty-btn" onclick="setDifficulty('advanced')">Advanced</div>
            </div>
        </div>

        <!-- Sidebar Section -->
        <div class="chess-sidebar">
            <h3 class="tech-subheading">Game Information</h3>
            
            <div class="chess-stats">
                <div class="tech-card" style="text-align: center;">
                    <div class="metric-value" id="playerScore">0</div>
                    <div>Your Score</div>
                </div>
                <div class="tech-card" style="text-align: center;">
                    <div class="metric-value" id="aiScore">0</div>
                    <div>AI Score</div>
                </div>
            </div>

            <div class="tech-card">
                <h4>Current Status</h4>
                <p id="gameStatus" style="margin: 10px 0; color: var(--cyber-blue);">Waiting for your move...</p>
            </div>

            <div class="move-history">
                <h4>Move History</h4>
                <div id="moveList">
                    <!-- Moves will appear here -->
                </div>
            </div>

            <div class="tech-card">
                <h4>üéØ Learning Goals</h4>
                <ul style="margin: 10px 0; padding-left: 20px;">
                    <li>‚úÖ Understand piece values</li>
                    <li>‚úÖ Learn basic openings</li>
                    <li>üî≤ Practice checkmate patterns</li>
                    <li>üî≤ Develop tactical awareness</li>
                </ul>
            </div>

            <!-- Parent Ad Spot -->
            <div class="ad-parents-spot" style="margin-top: 20px;"></div>
        </div>
    </div>

    <!-- Consistent Footer -->
    <footer class="tech-footer">
        <div style="text-align: center; padding: 40px 20px;">
            <div class="nav-brand" style="justify-content: center; margin-bottom: 20px;">
                <span class="brain-icon">üß†</span>
                <span class="brand-main">MindFlow</span>
                <span class="brand-sub">Powered by MindTech</span>
            </div>
            <div class="ad-children-spot"></div>
            <div class="copyright">
                ¬© 2025 MindTech Industries. All rights reserved.
            </div>
        </div>
    </footer>

    <!-- Chess Libraries -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/chess.js/0.10.3/chess.min.js"></script>
    <script src="https://unpkg.com/@chrisoakman/chessboardjs@1.0.0/dist/chessboard-1.0.0.min.js"></script>
    
    <!-- Chess Systems -->
    <script src="assets/js/enhanced-tracker.js"></script>
    <script src="assets/js/ad-system.js"></script>
    <script src="assets/js/chess-manager.js"></script>
    
    <script>
        // Simple chess manager for demo
        class ChessManager {
            constructor() {
                this.playerScore = 0;
                this.aiScore = 0;
                this.game = new Chess();
                this.board = null;
                this.init();
            }

            init() {
                console.log('‚ôüÔ∏è Chess Manager Initialized');
                this.initBoard();
                this.updateScores();
            }

            initBoard() {
                this.board = Chessboard('chessBoard', {
                    draggable: true,
                    position: 'start',
                    onDrop: this.handleMove.bind(this),
                    orientation: 'white'
                });
            }

            handleMove(source, target) {
                const move = this.game.move({
                    from: source,
                    to: target,
                    promotion: 'q'
                });

                if (move === null) return 'snapback';

                this.addMoveToHistory(move);
                
                // AI makes random move after delay
                setTimeout(() => {
                    this.makeAIMove();
                }, 1000);

                return true;
            }

            makeAIMove() {
                const moves = this.game.moves();
                if (moves.length === 0) return;

                const randomMove = moves[Math.floor(Math.random() * moves.length)];
                this.game.move(randomMove);
                this.board.position(this.game.fen());
                
                this.addMoveToHistory(randomMove);
                this.updateGameStatus();
            }

            addMoveToHistory(move) {
                const moveList = document.getElementById('moveList');
                const moveItem = document.createElement('div');
                moveItem.className = 'move-item';
                moveItem.innerHTML = `
                    <span>${move.san || move}</span>
                    <span>${this.game.turn() === 'w' ? 'AI' : 'You'}</span>
                `;
                moveList.appendChild(moveItem);
                moveList.scrollTop = moveList.scrollHeight;
            }

            updateGameStatus() {
                const statusElement = document.getElementById('gameStatus');
                if (this.game.in_checkmate()) {
                    statusElement.textContent = 'Checkmate! ' + (this.game.turn() === 'w' ? 'You win!' : 'AI wins!');
                    if (this.game.turn() === 'w') this.playerScore += 10;
                    else this.aiScore += 10;
                    this.updateScores();
                } else if (this.game.in_draw()) {
                    statusElement.textContent = 'Game drawn!';
                } else if (this.game.in_check()) {
                    statusElement.textContent = 'Check!';
                } else {
                    statusElement.textContent = this.game.turn() === 'w' ? 'Your turn' : 'AI thinking...';
                }
            }

            newGame() {
                this.game = new Chess();
                this.board.start();
                document.getElementById('gameStatus').textContent = 'New game started! Your turn.';
                document.getElementById('moveList').innerHTML = '';
                this.khensaniAdvice();
            }

            getHint() {
                const moves = this.game.moves();
                if (moves.length > 0) {
                    const hint = moves[Math.floor(Math.random() * moves.length)];
                    this.showKhensaniMessage(`Try moving to ${hint} for a strong position!`);
                }
            }

            undoMove() {
                this.game.undo();
                this.game.undo(); // Undo both moves
                this.board.position(this.game.fen());
                document.getElementById('gameStatus').textContent = 'Move undone. Your turn.';
            }

            resign() {
                this.aiScore += 5;
                this.updateScores();
                this.showKhensaniMessage("Game resigned. Don't give up! Every game is a learning opportunity.");
                document.getElementById('gameStatus').textContent = 'Game resigned.';
            }

            khensaniAdvice() {
                const tips = [
                    "Control the center squares - they're the heart of the board!",
                    "Develop your knights and bishops before moving the same piece twice.",
                    "Castle early to keep your king safe and connect your rooks.",
                    "Look for forks and pins to win material from your opponent.",
                    "Every move should have a purpose - don't just move randomly!",
                    "Protect your pieces and attack undefended enemy pieces."
                ];
                const randomTip = tips[Math.floor(Math.random() * tips.length)];
                this.showKhensaniMessage(randomTip);
            }

            showKhensaniMessage(message) {
                document.getElementById('khensaniMessage').textContent = `"${message}"`;
            }

            updateScores() {
                document.getElementById('playerScore').textContent = this.playerScore;
                document.getElementById('aiScore').textContent = this.aiScore;
            }
        }

        function setDifficulty(level) {
            document.querySelectorAll('.difficulty-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            event.target.classList.add('active');
            window.chessManager.showKhensaniMessage(`Difficulty set to ${level}! Let's see what you can do!`);
        }

        // Initialize chess manager
        document.addEventListener('DOMContentLoaded', function() {
            window.chessManager = new ChessManager();
        });
    </script>
</body>
</html>